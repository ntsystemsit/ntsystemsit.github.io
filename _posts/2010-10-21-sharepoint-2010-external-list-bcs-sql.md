---
layout: post
title: "Sharepoint 2010, external List, BCS, SQL"
date: 2010-10-21 21:56:00 +0200
comments: true
published: true
categories: ["blog", "archives"]
excerpt_separator: <!-- more -->
tags: ["Sharepoint", "SQL"]
alias: ["/post/Sharepoint-2010-external-List-BCS-SQL.aspx", "/post/sharepoint-2010-external-list-bcs-sql.aspx"]
---
<!-- more -->
{% include imported_disclaimer.html %}
<p>In diesem Post werde ich die einzelnen Schritte erklären um in Sharepoint eine SQL Tabelle einzubinden. Dazu erforderlich ist:</p>  <ul>   <li>Sharepoint 2010 Foundation / Server </li>    <li>SQL Server </li>    <li>Sharepoint Designer 2010 </li> </ul>  <p><strong>Externen Inhaltstyp definieren</strong></p>  <p>In diesem Schritt definieren wir den Inhaltstyp und somit die Verbindung zu SQL Server. Dies kann alles mit dem Sharepoint Designer erledigt werden. Unter Externe Inhaltstypen definieren wir die Verbindung.</p>  <p><a href="/assets/image_275.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_273.png" width="244" height="170" /></a></p>  <p>Nun kann ein Name und die Verbindung zu SQL Server angegeben werden, indem wir auf “<strong>Klicken Sie hier, um externe Datenquellen zu ermitteln und Vorgänge zu definieren</strong>” klicken</p>  <p><a href="/assets/image_276.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_274.png" width="244" height="104" /></a></p>  <p>Wir erstellen eine neue Verbindung vom Typ <strong>SQL Server </strong>und geben die Datenbankinformationen an</p>  <p><a href="/assets/image_277.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_275.png" width="244" height="137" /></a></p>  <p>Nun können wir die Tabellen auswählen, die für diesen Inhaltstyp zur Verfügung stehen. Dabei klicken wir auf die Tabelle und können verschiedene Vorgänge definieren:</p>  <ul>   <li><strong>Element lesen</strong> </li>    <li><strong>Liste lesen</strong> </li>    <li><strong>Erstellen</strong> </li>    <li><strong>Aktualisieren</strong> </li>    <li><strong>Löschen</strong> </li> </ul>  <p><a href="/assets/image_278.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_276.png" width="244" height="168" /></a></p>  <p>Nun ist der Inhaltstyp definiert und steht in Sharepoint zur Verfügung.</p>  <p>&#160;</p>  <p><strong>BCS Berechtigungen definieren</strong></p>  <p>Standardmäßig haben wir keine Berechtigung um auf den Inhaltstyp zuzugreifen. Dies müssen wir erst in den BCS Einstellungen definieren. Am schnellsten kann dies über die Zentraladministration erledigt werden.</p>  <p><strong>Zentraladministration / Anwendungsverwaltung / Dienstanwendungen verwalten</strong></p>  <p>Nun wählen wir den<strong> Business Data Connectivity-Dienst </strong>und definieren die Berechtigungen für den Inhaltstyp.</p>  <p><a href="/assets/image_279.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_277.png" width="244" height="196" /></a></p>  <p><strong>Info</strong>: Mindestens 1 Account muss das Buntzerrecht “<strong>Berechtigungen festlegen</strong>” haben.</p>  <p>Jetzt können wir die externe Liste erstellen und hätten theoretisch Zugriff darauf, wäre da nicht das <a href="http://blogs.msdn.com/b/knowledgecast/archive/2007/01/31/the-double-hop-problem.aspx" target="_blank">Double-Hop</a> Problem. Beim Zugriff erhalten wir folgende Fehlermeldung:</p>  <p><a href="/assets/image_280.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_278.png" width="244" height="91" /></a></p>  <p>&#160;</p>  <p><strong>Double-Hop Problem beheben</strong></p>  <p>Um das Double-Hop Problem zu lösen gehen wir folgendermaßen vor:</p>  <p>1. Zunächst erstellen wir einen neuen SPN (Service Principal Name) für unseren SQL Server:</p>  <p><strong>setspn –A MSSQLsvc/NETBIOSNAME.DOMAIN:1433 DOMAIN\SQL-Service-Account</strong></p>  <p>Der SQL Service Account kann am schnellsten unter den Diensten ermittelt werden.</p>  <p>2. Danach müssen wir in ActiveDirectory die Delegierungen für folgende Objekte aktivieren</p>  <ul>   <li>Sharepoint Computer-Objekt </li>    <li>SQL-Service Account </li> </ul>  <p><a href="/assets/image_281.png"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_thumb_279.png" width="201" height="244" /></a></p>  <p>Ich empfehle den Sharepoint sowie den SQL Server neu zu starten um sicherzugehen, dass die Konfiguration aktiv ist.</p>  <p>Jetzt haben wir Zugriff auf die SQL Tabelle über Sharepoint.</p>  <p>&#160;</p>  <p>Nähere Informationen zur Double-Hop Problematik unter folgenden <a href="http://blogs.msdn.com/b/knowledgecast/archive/2007/01/31/the-double-hop-problem.aspx" target="_blank">Link</a></p>  <p>&#160;</p>  <p>Grüße    <br />dn</p>
