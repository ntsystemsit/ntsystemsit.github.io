---
layout: post
title: "My PowerShell Profile"
date: 2012-07-29 20:41:00 +0200
comments: true
published: true
excerpt_separator: <!-- more -->
categories: Archive
tags: ["PowerShell"]
redirect_from: ["/post/My-PowerShell-Profile", "/post/my-powershell-profile"]
author: thomas torggler
---
<!-- more -->
{% include imported_disclaimer.html %}
<p>Today I am going to walk you through my PowerShell Profile and try to explain the basics of what a Profile is and how it can be used.</p>  <h1></h1>  <h1>So what is a Profile, and where is it?</h1>  <p>Well, basically a profile is a PowerShell script file (.ps1) that is stored in a preconfigured location and that gets executed every time PowerShell starts. This script enables you to customize your PowerShell session and predefine settings as you find them useful. There is a built-in variable, $Profile, which stores the location of the script that is executed every time PowerShell starts. </p>  <p>The profile file is located in the WindowsPowerShell folder in every users “My Documents” folder. It has to be named Microsoft.PowerShell_profile.ps1.</p>  <p><a href="/assets/image_446.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_thumb_444.png" width="244" height="14" /></a></p>  <p>By default there is no profile and everything is left to their defaults, to create the profile script you can create the WindowsPowerShell folder and then use notepad to save a file containing some PowerShell commands in that folder. You can also use the New-Item cmdlet to create the folder and an empty file by typing:</p>  <p>New-Item –Path $Profile -Type File –Force </p>  <h1>Example profile</h1>  <p>Now that we know what a profile is and where it is located we can go on and take a look at an example profile, it’s actually my profile so if you have any tips for me, feel free to leave a comment.</p>  <p>I am starting my Profile with setting some variables, some are predefined and some are custom, I use them for the following settings:</p>  <p>$MaximumHistoryCount is used to set the number of commands that are stored in History. Defaults to 64. Maximum 32767.    <br />$Transcript is used to set the path for Start-Transcript     <br />$env:PSModulePath is an environment variable (‘env:’) and it is used to customize the path where PowerShell will look for modules to import.     <br />$cert is a variable I use to store my CodeSigningCert to sign scripts.</p>  <p>After that I use Get-Host to figure out which version of PowerShell is running in the current session, if version 3 is detected, I set some DefaultParameterValues using $PSDefaultParameterValues. After that I check if the current session was started with “Run as administrator” if it was, the Update-Help cmdlet is run.</p>  <p>Since I am writing a module I have a short function to just make my life a little easier, it signs the module file using Set-AuthenticodeSignature and then copies the file to some network share for my coworkers.</p>  <p>At the end I am creating a new PSDrive of the FileSystem PS provider, after creating the drive the current location is set to that drive. This is my working directory, it contains all the scripts and test files I need.</p>  <p>I pasted the file to <a href="http://poshcode.org/3552">http://poshcode.org</a>, I really like their “embed code” feature.</p> <script type="text/javascript" src="http://PoshCode.org/embed/3552"></script>  <p>&#160;</p>  <p>Now again, this is my profile, I use it to simply show what can be done, since I am still a beginner I appreciate ideas and tips from anyone!</p>  <p>tom</p>
