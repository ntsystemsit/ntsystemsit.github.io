---
layout: post
title: "Lync 2013 – Installation and Certificates"
date: 2013-02-02 15:35:00 +0100
comments: true
published: true
excerpt_separator: <!-- more -->
categories: Archive
tags: ["Lync", "Server 2012"]
redirect_from: ["/post/Lync-2013-Installation-and-Certificates", "/post/lync-2013-installation-and-certificates"]
author: thomas torggler
---
<!-- more -->
{% include imported_disclaimer.html %}
<p>This post is the follow-up to <a href="/post/Lync-2013-Prepare-AD-and-build-Topology.aspx" target="_blank">the one about AD and topology preparation</a> and I will again use screenshots to walk through the Installation and Certificate request and assignment processes.</p>  <h1>DNS Records</h1>  <p>The last post ended with publishing the Topology, after that, the wizard provides a simple To-Do list, summarizing the next steps. Creating the DNS records for our Simple URLs was one of them. So, using DNSmgmt.msc I created CNames for the meet, dialin and lyncadmin URLs, all pointing to the Lync Front End Server.</p>  <p>The DNS Records used for automatic sign-in are not mentioned in said To-Do list, though. I created the sip.tomt.local record as just another alias pointing to the Lync FE Server. Automatic Sign-in also needs the following Service Location Record (SRV)</p>  <p><code>_sipinternaltls._tcp.tomt.local SRV service location:     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; port&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 5061      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; svr hostname&#160;&#160; = lyfe01.tomt.local</code></p>  <p>All in all, I do now have the following DNS Records:</p>  <table cellspacing="0" cellpadding="2" width="452" border="0"><tbody>     <tr>       <td valign="top" width="123">HostName</td>        <td valign="top" width="99">RecordType</td>        <td valign="top" width="228">RecordData</td>     </tr>      <tr>       <td valign="top" width="123">_sipinternaltls._tcp</td>        <td valign="top" width="99">SRV</td>        <td valign="top" width="228">[0][0][5061][lyfe01.tomt.local.]</td>     </tr>      <tr>       <td valign="top" width="123">lyfe01</td>        <td valign="top" width="99">A</td>        <td valign="top" width="228">10.1.1.11</td>     </tr>      <tr>       <td valign="top" width="123">dialin</td>        <td valign="top" width="99">CNAME</td>        <td valign="top" width="228">lyfe01.tomt.local.</td>     </tr>      <tr>       <td valign="top" width="123">meet</td>        <td valign="top" width="99">CNAME</td>        <td valign="top" width="228">lyfe01.tomt.local.</td>     </tr>      <tr>       <td valign="top" width="123">sip</td>        <td valign="top" width="99">CNAME</td>        <td valign="top" width="228">lyfe01.tomt.local.</td>     </tr>      <tr>       <td valign="top" width="123">lyncadmin</td>        <td valign="top" width="99">CNAME</td>        <td valign="top" width="228">lyfe01.tomt.local.</td>     </tr>   </tbody></table>  <h1>Server Prerequisites</h1>  <p>The next step is to install the prerequisites on the Lync Server, for more information check <a href="http://technet.microsoft.com/en-us/library/gg398588.aspx" target="_blank">TechNet</a>. I use the following PowerShell cmdlet to install Lync Server prerequisites, make sure you specify a “–Source”.</p>  <blockquote>   <p style="font-size: 11pt; font-family: calibri; margin: 0in"><span lang="de">Add-WindowsFeature </span><span lang="en-US">NET-Framework-Core, NET-Framework-45-Features, RSAT-ADDS, Web-Server, Web-Static-Content, Web-Default-Doc, Web-Http-Errors, Web-Http-Redirect, Web-Asp-Net, Web-Net-Ext, Web-ISAPI-Ext, Web-ISAPI-Filter, Web-Http-Logging, Web-Log-Libraries, Web-Http-Tracing, Web-Windows-Auth, Web-Client-Auth, Web-Basic-Auth, Web-Filtering, Web-Stat-Compression, Web-Dyn-Compression, Web-Mgmt-Console, Web-Scripting-Tools, Web-Request-Monitor, NET-WCF-HTTP-Activation45, Web-Asp-Net45, Web-Mgmt-Tools, Web-Mgmt-Compat, Desktop-Experience, Telnet-Client, BITS, Windows-Identity-Foundation –Source ‘D:\sources\sxs’ –Restart</span></code></p>  <p>Now after the reboot open Lync Deployment Wizard again and click &quot;Install or Update Lync Server System&quot;</p>  <p><a href="/assets/clip_image001_5.png"><img title="clip_image001" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image001" src="/assets/clip_image001_thumb_5.png" width="244" height="190" /></a></p>  <p>After installing Local Configuration Store and Lync Server Components, we need to request and assign Certificates for Lync to use.</p>  <p><a href="/assets/clip_image002_3.png"><img title="clip_image002" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image002" src="/assets/clip_image002_thumb_3.png" width="244" height="190" /></a></p>  <p>If you use an online (enterprise) CA, select send request immediately, if you intend to send the request to a public CA, select the offline certificate request option. As I have ADCS installed in my test forest, I use the enterprise CA for this.</p>  <p><a href="/assets/clip_image004_2.png"><img title="clip_image004" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image004" src="/assets/clip_image004_thumb_2.png" width="244" height="185" /></a></p>  <p>Optionally specify credentials and a certificate template, if your current user has permissions to request a certificate using the “WebServer” template, click next. Then specify the friendly name for and the key length for the certificate.</p>  <p><a href="/assets/clip_image005_2.png"><img title="clip_image005" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image005" src="/assets/clip_image005_thumb_2.png" width="244" height="185" /></a></p>  <p>Lync automatically includes the required Alternative Names along with Simple URLs and external pool name. Other details (such as City, Country, Region) typically used in certificate requests can be specified too.</p>  <p><a href="/assets/clip_image006_1.png"><img title="clip_image006" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image006" src="/assets/clip_image006_thumb_1.png" width="244" height="185" /></a></p>  <p>Select the SIP Domains, so that they are included, too. You can optionally add additional SANs, I didn’t need any more than the ones included by the wizard.</p>  <p>Request the Certificate and tick the “Assign this certificate…” checkbox.</p>  <p><a href="/assets/clip_image007_2.png"><img title="clip_image007" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image007" src="/assets/clip_image007_thumb_2.png" width="244" height="185" /></a></p>  <p>If you plan to use Server-to-Server authentication (Office Web Apps, Exchange, SharePoint) also request an OAuth Certificate. The procedure is the same as for the Server certificate.</p>  <p><a href="/assets/clip_image008_2.png"><img title="clip_image008" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image008" src="/assets/clip_image008_thumb_2.png" width="244" height="133" /></a></p>  <p>The OAuth Certificate is a &quot;Global&quot; Certificate, that means that Lync Central Management Store replicates it to all Lync Servers, and all Lync Servers will use the same Certificate for OAuth.</p>  <h1>Starting the Services</h1>  <p>Phew, now after all those steps, we can finally go ahead and start the services. Give it some time, and check if all services are started using services.msc.</p>  <p>Now, we can use Lync Server Control Panel to check out our work. I prefer to use the Control Panel on my client PC, as it requires Silverlight to be installed. So, on a Computer sporting Silverlight, open the Simple Administration URL specified before.</p>  <p><a href="/assets/image_492.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="/assets/image_thumb_490.png" width="244" height="154" /></a> </p>  <p>I will continue to test some features of Lync 2013, stay tuned for more!</p>  <p>&#160;</p>  <p>so long, have a nice weekend!   <br />tom</p>
