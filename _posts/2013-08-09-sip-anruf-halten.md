---
layout: post
title: "SIP: Anruf halten"
date: 2013-08-09 22:37:50 +0200
comments: true
category: Archive
tags: []
redirect_from: ["/page/SIP-Anruf-halten", "/page/sip-anruf-halten"]
author: thomas torggler
---
<!-- more -->
<p>An dieser Stelle möchte ich einen Blick auf die SIP Kommunikation in einem Anruf halten Szenario werfen. Die Informationen aus der SIP Kommunikation die ich im folgenden zeige sind auf das absolute Minimum beschränkt, ein wirkliches SIP Paket enthält viel mehr Informationen. </p>  <p>Im folgenden Beispiel ruft Teilnehmer A (+49151xxxxxxxx) Teilnehmer B (+39047xxxxx) an, Teilnehmer B nimmt das Gespräch an. Anschließend hält Teilnehmer B das Gespräch. Die Frage die sich stellt ist natürlich wie signalisiert ein Teilnehmer (B) dem anderen (A) dass er das Gespräch halten möchte?</p>  <h1>INVITE / OK</h1>  <p>Bevor ein Gespräch gehalten werden kann, muss dieses aufgebaut werden. Dazu sendet Teilnehmer A eine INVITE Anfrage an Teilnehmer B. Der Header beschreibt die SIP Sitzung, im Body wird mit SDP die Medien Sitzung beschrieben. Die interessanten Felder fasse ich hier zusammen:</p>  <p><strong>Invite Header:      <br /></strong>From: &lt;sip:+49151xxxxxxxx@uclab.eu;user=phone&gt;;epid=5075F8584B;tag=1559ef9c1     <br />To: &lt;sip:+39047xxxxx@uclab.eu;user=phone&gt;;epid=ea6d933f37     <br />CSeq: 24467 INVITE     <br />Call-ID: c73279cc-a979-40b4-bb7b-6e261ab0ddc4</p>  <p><strong>Invite Body:      <br /></strong>c=IN IP4 192.168.1.100     <br />m=audio 54720 RTP/AVP 0 8 115 13 118 97 101</p>  <p>Der Lync Client des angerufenen Teilnehmers (B) muss die empfangene Anfrage beantworten und macht dies mit einem 200 OK. In diesem schickt er SDP Informationen mit, welche die RTP Sitzung aus seiner Sicht beschreiben:</p>  <p><strong>Ok Header:      <br /></strong>From: &lt;sip:+49151xxxxxxxx@uclab.eu;;user=phone&gt;;epid=5075F8584B;tag=1559ef9c1     <br />To: &lt;sip:+39047xxxxx@uclab.eu;user=phone&gt;;epid=ea6d933f37;tag=4f75d0c634     <br />Call-ID: c73279cc-a979-40b4-bb7b-6e261ab0ddc4     <br />CSeq: 24467 INVITE</p>  <p><strong>Ok Body:      <br /></strong>c=IN IP4 192.168.1.6     <br />m=audio 8746 RTP/AVP 8 0 13 101</p>  <h1>re-INVITE / OK</h1>  <p>Um eine existierende SIP Sitzung (Dialog) zu ändern, schickt Teilnehmer B ein INVITE bei dem die Werte für Call-ID sowie From und To Tag identisch mit denen aus der bestehenden Sitzung sind. Man spricht in diesem Fall von einem re-Invite. Das Ziel dieses erneuten Invites ist es die RTP Sitzung zu ändern, also schickt der User Agent des Teilnehmer B neue SDP Informationen an Teilnehmer A, diese enthalten die Beschreibung der RTP Sitzung aus sicht von Teilnhemer B.</p>  <p><strong>re-Invite Header:</strong>     <br />From: &quot;&quot; &lt;sip:+39047xxxxx@uclab.eu;user=phone&gt;;epid=ea6d933f37;tag=4f75d0c634     <br />To: &lt;sip:+49151xxxxxxxx@uclab.eu;;user=phone&gt;;epid=5075F8584B;tag=1559ef9c1     <br />Call-ID: c73279cc-a979-40b4-bb7b-6e261ab0ddc4     <br />CSeq: 1 INVITE</p>  <p><strong>re-Invite Body:      <br /></strong>c=IN IP4 192.168.1.6     <br />m=audio 8746 RTP/AVP 8 0 13 101     <br />a=sendonly</p>  <p>Auch diese Anfrage muss der Lync Client beantworten, in diesem Fall erhält Teilnehmer A die Invite Nachricht, Teilnehmer B möchte das Gespräch halten.</p>  <p><strong>Ok Header:      <br /></strong>From: &quot;&quot;&lt;sip:+39047xxxxx@uclab.eu;user=phone&gt;;tag=4f75d0c634;epid=ea6d933f37     <br />To: &lt;sip:+49151xxxxxxxx@uclab.eu;user=phone&gt;;epid=5075F8584B;tag=1559ef9c1     <br />CSeq: 1 INVITE     <br />Call-ID: c73279cc-a979-40b4-bb7b-6e261ab0ddc4</p>  <p><strong>Ok Body:      <br /></strong>c=IN IP4 192.168.1.100     <br />m=audio 6190 RTP/AVP 8 13 101     <br />a=recvonly</p>
{% include imported_disclaimer.html %}
