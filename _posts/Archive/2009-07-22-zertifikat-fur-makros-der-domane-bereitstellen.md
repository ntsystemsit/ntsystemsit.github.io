---
layout: post
title: "Zertifikat für Makros der Domäne bereitstellen"
date: 2009-07-22 08:03:19 +0200
comments: true
category: Archive
tags: []
redirect_from: ["/post/Zertifikat-fur-Makros-der-Domane-bereitstellen", "/post/zertifikat-fur-makros-der-domane-bereitstellen"]
author: daniel nitz
---
<!-- more -->
<p>Letzens habe ich mir vorgenommen alle von mir geschriebenen Makros digital zu signieren, sodass die User beim Öffnen der Dateien keine Abfragen bekommen ob sie den Code aktivieren möchten oder nicht. </p>  <p>Um einen Makro digital zu signieren und das Zertifikat der Domäne zur Verfügung zu stellen bedarf es mehrerer Schritte: </p>  <ol>   <li>Zertifikatdienste auf einem Server installieren </li>    <li>Zertifikat zur Codesignatur ausstellen </li>    <li>Makros digital signieren und die Office-Files ablegen </li> </ol>  <p>Nun muss nur mehr das Zertifikat den Usern bereit gestellt werden. Wenn man das mit einem GPO macht, muss darauf geachtet werden, dass man die Einstellungen für Computer vornimmt. </p>  <p>Das Zertifikat muss als erstes unter die Vertrauenswürdigen Stammzertifizierungsstellen </p>  <p>Computerkonfiguration &gt; Windows-Einstellungen &gt; Sicherheitseinstellungen &gt; Richtlinien öffentlicher Schlüssel &gt; Vertrauenswürdige Stammzertifizierungsstellen </p>  <p><a href="/assets/archive/image.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/archive/image_thumb.png" width="470" height="251" /></a></p>  <p> Bis hierher wird das Zertifikat in den lokalen Zertifikat-Speicher “Vertrauenswürdigen Stammzertifizierungsstellen” geschoben. Das Zertifikat muss aber noch in den Speicher für “Vertrauenswürdige Herausgeber”, sonst erscheinen weiterhin Abfragen. Um das Zertifikat da rein zubekommen muss im vorher konfigurierten GPO eine neue “Richtlinie zur Softwareeinschränkung” erstellt werden. </p>  <p>Computerkonfiguration &gt; Windows-Einstellungen &gt; Sicherheitseinstellungen &gt; Richtlinien öffentlicher Schlüssel &gt; Richtlinien für Softwareeinschränkung </p>  <p>Danach muss unter “Zusätzliche Regeln” eine neue Zertifikatsregel mit den entsprechenden Zertifikat erstellt werden. </p>  <p><a href="/assets/archive/image_1.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/archive/image_thumb_1.png" width="475" height="257" /></a></p>  <p>Wichtig dabei ist, dass die Sicherheitsstufe “Nicht eingeschränkt” lautet.</p>  <p><a href="/assets/archive/image_3.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/archive/image_thumb_3.png" width="334" height="369" /></a> </p>  <p>Nun wird das Zertifikat an alle Computer unter dem GPO verteilt. Alle digital signierten Makros werden ohne Abfrage ausgeführt.</p>
{% include imported_disclaimer.html %}
