---
layout: post
title: "Patching Office Web Apps Server"
date: 2013-03-28 17:36:00 +0100
comments: true
category: Archive
tags: ["Server"]
redirect_from: ["/post/Patching-Office-Web-Apps-Server", "/post/patching-office-web-apps-server"]
author: thomas torggler
---
<!-- more -->
<p>Today I started my day with an Office Web Apps Farm that was not working anymore. After reviewing the Event Log I figured something strange happened… :) </p>  <p><a href="/assets/archive/image_499.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="/assets/archive/image_thumb_497.png" width="244" height="158" /></a> </p>  <p>The Event Log was basically full with .Net Runtime and Application Errors, I’ll paste some for reference.</p>  <p><code>Log Name: Application      <br />Source: .NET Runtime       <br />Event ID: 1026       <br />Application: ppteditingbackendwatchdog.exe       <br />Framework Version: v4.0.30319       <br />Description: The process was terminated due to an unhandled exception.       <br />Exception Info: System.TypeInitializationException       <br />Stack:       <br />&#160;&#160; at Microsoft.Office.Web.Common.ServiceInstanceFinder.GetLocalAgentInstance(Microsoft.Office.Web.Common.OfficeServiceType)       <br />&#160;&#160; at Microsoft.Office.Web.Common.WatchdogHelper.PrepareRegistrations(Microsoft.Office.Web.Common.OfficeServiceType)       <br />&#160;&#160; at Microsoft.Office.Web.Common.WatchdogHelper.WatchMachines(Microsoft.Office.Web.Common.OfficeServiceType, CheckServiceInstance, Microsoft.Office.Web.Common.OfficeServiceType, System.String)       <br />&#160;&#160; at Microsoft.Office.Server.Powerpoint.Watchdog.EditingBackend.Program.Main(System.String[])</p>    <p>Log Name: Application      <br />Source: Application Error       <br />Event ID: 1000       <br />Faulting application name: ppteditingbackendwatchdog.exe, version: 15.0.4481.1000, time stamp: 0x50ee5a9e       <br />Faulting module name: KERNELBASE.dll, version: 6.2.9200.16451, time stamp: 0x50988aa6       <br />Exception code: 0xe0434352       <br />Fault offset: 0x000000000003811c       <br />Faulting process id: 0x94c       <br />Faulting application start time: 0x01ce2b83409e789a       <br />Faulting application path: C:\Program Files\Microsoft Office Web Apps\PowerPointEditingServicesWatchdog_App\ppteditingbackendwatchdog.exe       <br />Faulting module path: C:\Windows\system32\KERNELBASE.dll       <br />Report Id: 7e88e5ec-9776-11e2-93f3-0050569e79e3       <br />Faulting package full name:       <br />Faulting package-relative application ID: </code></p>  <p>There would be the same errors for all of the Web Apps (Excel, Word…) Needless to say, neither SharePoint 2013 nor Lync 2013 would be able to leverage features that required Web Apps Server. So, what’s next? </p>  <p>Well I continued digging through the Event Log and realized that the Server was patched and restarted very recently, as part of the patching someone applied <a href="http://www.microsoft.com/en-us/download/details.aspx?id=36981" target="_blank">KB2760445</a>. Sweet.</p>  <p>So I started searching TechNet for information on that Update for Office Web Apps and found a nice article on how to “<a href="http://technet.microsoft.com/en-us/library/jj966220.aspx" target="_blank">Apply software updates to Office Web Apps Server</a>”. Basically it goes like this: After patching the Server, you will have to re-create the Office Web Apps Farm. In my case, I simply removed the farm using</p>  <p><code>Remove-OfficeWebAppsMachine</code></p>  <p>and then re-used the same cmdlet I used to <a href="/post/Office-2013-Web-Apps.aspx" target="_blank">create the Web Apps Farm</a> initially.</p>  <p><code>New-OfficeWebAppsFarm -InternalUrl &quot;https://myOWAserver.tomt.local&quot; -ExternalUrl &quot;https://office.ntsystems.it&quot; –CertificateName &quot;ntSystems OfficeWebApps&quot; –EditingEnabled </code></p>  <p>All set.</p>  <p>If there is one take-away from this, it is very likely: Read that documentation, oh, and please, do test!</p>  <p>Tom</p>
{% include imported_disclaimer.html %}
