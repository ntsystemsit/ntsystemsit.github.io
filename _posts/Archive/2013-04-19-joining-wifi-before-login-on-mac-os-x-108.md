---
layout: post
title: "Joining WiFi before login on Mac OS X 10.8"
date: 2013-04-19 23:03:47 +0200
comments: true
category: Archive
tags: ["Network"]
redirect_from: ["/post/Joining-WiFi-before-login-on-Mac-OS-X-108", "/post/joining-wifi-before-login-on-mac-os-x-108"]
author: thomas torggler
---
<!-- more -->
<p>We had an interesting problem at work recently, as the solution was a little complex I decided to write about it here. So, as the title suggests, we are talking Wireless networking, authentication and Mac OS X today. It’ll be fun, trust me :)</p>  <p>Some prerequisites: We use EAP-TLS as the authentication protocol for WiFi and SCEP for certificate enrollment. I’ve written <a href="/post/Microsoft-NDES-and-Cisco-IOS-part-1.aspx" target="_blank">about SCEP</a> before, in a different context, though. We also use the <a href="http://support.apple.com/kb/DL1466" target="_blank">iPhone Configuration Utility</a> to deploy configurations to devices, more on that later. </p>  <h1>The Problem</h1>  <p>We join our MACs to the Active Directory domain and want our users to be able to login using their domain credentials. Obviously you need some sort of connectivity to the AD in order to login, we used to configure Wireless Networks as “System Profile” in OS X in the past. Unfortunately, that GUI went away in more recent versions of that operating system.</p>  <p><img alt="" src="http://km.support.apple.com/library/APPLE/APPLECARE_ALLGEOS/HT3326/profiles.png" /></p>  <p>This is a screenshot of 10.5, simple enough. As we tried to configure that same thing on 10.8, though, we realized that this little option was gone. All Wi-Fi networks would be started AFTER the used login, no AD login was possible. Oops.</p>  <p>After scratching our heads for a while, we found a workaround other than installing Windows ;)</p>  <h1>The Solution</h1>  <p>iPhone Configuration Utility was used ever since we had the requirement to connect iOS devices to the wireless network, it can be used to create configuration files that can be deployed to iOS devices. It has been possible for some time to deploy these same configuration files to OS X, too. As they are simple XML files, we took a deeper look into them. Wwith some help from Google we found that we could change the Wi-Fi payload to be a “System Profile” instead of a “User Profile”, and thus be started BEFORE user login.</p>  <p>So, first thing is to create a configuration profile using iPhone Configuration Utility.</p>  <p><a href="/assets/archive/image_500.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="/assets/archive/image_thumb_498.png" width="244" height="147" /></a> </p>  <p>Choose a name, identifier and description for the profile.</p>  <p><a href="/assets/archive/image_501.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="/assets/archive/image_thumb_499.png" width="244" height="147" /></a> </p>  <p>Add the certification authorities certificate, so we trust certificates issued by our internal CA. </p>  <p><a href="/assets/archive/image_502.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="/assets/archive/image_thumb_500.png" width="244" height="184" /></a> </p>  <p>Configure SCEP, the iPhone or MAC is going to connect to the SCEP URL to enroll a certificate using the specified subject.</p>  <p><a href="/assets/archive/image_503.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="/assets/archive/image_thumb_501.png" width="244" height="184" /></a> </p>  <p>Add the Wi-Fi payload, specifying the SSID and authentication protocol. As we use EAP-TLS we use the SCEP certificate to authenticate.</p>  <p>Once the profiles is configured, export it:</p>  <p><a href="/assets/archive/image_504.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="/assets/archive/image_thumb_502.png" width="244" height="115" /></a> </p>  <p>We get a .mobileconfig file from the export, it can be edited using a simple text editor. Here comes the fun part, we have to add the following lines to the configuration file:</p>  <p><code>&lt;key&gt;SetupModes&lt;/key&gt;      <br />&lt;array&gt;       <br />&lt;string&gt;System&lt;/string&gt;       <br />&lt;/array&gt;       <br />&lt;key&gt;PayloadScope&lt;/key&gt;       <br />&lt;string&gt;System&lt;/string&gt;</code></p>  <p>This part goes just underneath the PayloadOrganization in the AutoJoin section.</p>  <p>And we have to change “Configuration” at the very end of the file from:</p>  <p><code>&lt;key&gt;PayloadType&lt;/key&gt;      <br />&lt;string&gt;Configuration&lt;/string&gt;</code></p>  <p>to “SystemConfiguration”:</p>  <p><code>&lt;key&gt;PayloadType&lt;/key&gt;      <br />&lt;string&gt;SystemConfiguration&lt;/string&gt;</code></p>  <p>As it is quite important where you change/add the lines, I’ll paste a complete file for reference.</p>  <p><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;      <br />&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;<a href="http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;">http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</a>&gt;       <br />&lt;plist version=&quot;1.0&quot;&gt;       <br />&lt;dict&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadContent&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;AutoJoin&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;true/&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;EAPClientConfiguration&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;AcceptEAPTypes&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;13&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;EAPFASTProvisionPAC&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;false/&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;EAPFASTProvisionPACAnonymously&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;false/&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;EAPFASTUsePAC&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;false/&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadCertificateAnchorUUID&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;25800C8A-A389-4598-A3C4-F5569A4D5273&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;EncryptionType&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;WPA&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;HIDDEN_NETWORK&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;true/&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadCertificateUUID&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;40C2FC1D-D1AA-4BA6-B2A3-959B6BFF9EB1&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDescription&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;Configures wireless connectivity settings.&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDisplayName&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;WiFi (MYSSID)&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadIdentifier&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;it.tomt.wlanprofile.wifi1&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadOrganization&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt&lt;/string&gt;       <br /><strong>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;SetupModes&lt;/key&gt;        <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;System&lt;/string&gt;         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadScope&lt;/key&gt;         <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;System&lt;/string&gt;</strong>       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadType&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;com.apple.wifi.managed&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadUUID&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;2CD56B1A-068C-4F3C-AC43-9D4E2115260F&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadVersion&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;1&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;ProxyServer&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;proxy.ntsystems.it&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;ProxyServerPort&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;8080&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;ProxyType&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;Manual&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;SSID_STR&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;MYSSID&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadCertificateFileName&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt-DC01-CA&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadContent&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;data&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MIIDYzCCAkugAwIBAgIQL1CM7d+PQrhAgO7UcdHbyDANBgkqhkiG&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; …      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bnBODc20wZMRDAhWuA==       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/data&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDescription&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;Provides device authentication (certificate or identity).&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDisplayName&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt-DC01-CA&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadIdentifier&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;it.tomt.wlanprofile.credential2&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadOrganization&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadType&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;com.apple.security.root&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadUUID&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;25800C8A-A389-4598-A3C4-F5569A4D5273&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadVersion&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;1&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadContent&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Challenge&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;4F20EACEDE479165&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Key Type&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;RSA&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Key Usage&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;0&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Keysize&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;2048&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Name&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt-DC01-CA&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Retries&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;3&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;RetryDelay&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;10&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;Subject&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;CN&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;macbookair$&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;URL&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;<a href="https://scep.tomt.it/certsrv/mscep/mscep.dll">https://scep.tomt.it/certsrv/mscep/mscep.dll</a>&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/dict&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDescription&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;Configures SCEP&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadDisplayName&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;SCEP (tomt-DC01-CA)&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadIdentifier&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;it.tomt.wlanprofile.scep3&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadOrganization&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;tomt&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadType&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;com.apple.security.scep&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadUUID&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;string&gt;40C2FC1D-D1AA-4BA6-B2A3-959B6BFF9EB1&lt;/string&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;key&gt;PayloadVersion&lt;/key&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;integer&gt;1&lt;/integer&gt;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/dict&gt;       <br />&#160;&#160;&#160; &lt;/array&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadDescription&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;string&gt;&lt;/string&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadDisplayName&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;string&gt;tomt-wlan&lt;/string&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadIdentifier&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;string&gt;it.tomt.wlanprofile&lt;/string&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadOrganization&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;string&gt;tomt&lt;/string&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadRemovalDisallowed&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;false/&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadType&lt;/key&gt;       <br />&#160; <strong>&#160; &lt;string&gt;SystemConfiguration&lt;/string&gt;        <br /></strong>&#160;&#160;&#160; &lt;key&gt;PayloadUUID&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;string&gt;B58A2BCB-7617-421B-B0C8-12DE22B5A2B1&lt;/string&gt;       <br />&#160;&#160;&#160; &lt;key&gt;PayloadVersion&lt;/key&gt;       <br />&#160;&#160;&#160; &lt;integer&gt;1&lt;/integer&gt;       <br />&lt;/dict&gt;       <br />&lt;/plist&gt;</code></p>  <p>Now, if we copy that file to the MAC OS X machine, we can import the wireless configuration and it will be a system profile. Phew.</p>  <p>(In this case we need some sort of connectivity in order to enroll for a certificate over SCEP, this could be via LAN or an open guest Wi-Fi)</p>  <h1></h1>  <h1>Summary</h1>  <p>It might be though to get your head around this if EAP-TLS and SCEP are new, yet the same idea holds through for a Username/Password or even pre-shared key authentication protocol. The problem remains the same, Wi-Fi user profiles are started after the user logs on, rendering Active Directory logins impossible. We couldn’t find a solution to change that behavior without the iPhone Configuration Utility.</p>  <p>Would be happy to hear about others experiences with this stuff.</p>  <p>Special thanks to my mate @eduriz :)</p>  <p>&#160;</p>  <p>tom</p>
{% include imported_disclaimer.html %}
