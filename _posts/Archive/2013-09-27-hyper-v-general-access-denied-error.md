---
layout: post
title: "Hyper-V General access denied error"
date: 2013-09-27 22:16:33 +0200
comments: true
category: Archive
tags: ["en", "Hyper-V"]
redirect_from: ["/post/Hyper-V-General-access-denied-error", "/post/hyper-v-general-access-denied-error"]
author: thomas torggler
---
<!-- more -->
<p>Like many others in the ITPro world, I am using many VMs to demo, learn, troubleshoot all different kinds of products and customer scenarios. I also mess with the disk files a lot. Every now and then I get the following error when trying to start a VM:</p>  <p><code>Hyper-V Manager </p>    <p>An error occurred while attempting to start the selected virtual machine(s). </p>    <p>'dc02' failed to start. (Virtual machine ID F4E4E8F0-99BF-4282-99E3-F57AE7AC8708) </p>    <p>'dc02' Microsoft Emulated IDE Controller (Instance ID 83F8638B-8DCA-4152-9EDA-2CA8B33039B4): Failed to Power on with Error 'General access denied error' (0x80070005). (Virtual machine ID F4E4E8F0-99BF-4282-99E3-F57AE7AC8708) </p>    <p>'dc02': IDE/ATAPI Account does not have sufficient privilege to open attachment 'C:\Users\Public\Documents\Hyper-V\Virtual hard disks\dc02_2.vhdx'. Error: 'General access denied error' (0x80070005). (Virtual machine ID F4E4E8F0-99BF-4282-99E3-F57AE7AC8708) </p>    <p>'dc02':&#160; Account does not have sufficient privilege to open attachment 'C:\Users\Public\Documents\Hyper-V\Virtual hard disks\dc02_2.vhdx'. Error: 'General access denied error' (0x80070005). (Virtual machine ID F4E4E8F0-99BF-4282-99E3-F57AE7AC8708) </code></p>  <h1>Problem</h1>  <p>The problem is rather simple, and since Hyper-V has been around for some time now, it should also be well-known to most of us: The VM does not have the necessary (read, write) permissions to use the assigned .vhd or .vhdx disk. So how do you restore the permissions?</p>  <h1>Solution</h1>  <p>As always, there are many solutions, one could use Hyper-V manager, remove the disk from the affected VM and then add it again. You could even use icacls to somehow get the ACLs right.</p>  <p>Or, simply use my <a href="/page/PS-Restore-VMPermissionps1.aspx" target="_blank">Restore-VMPermission script</a> :)</p>  <p>It’s a PowerShell script that can be used to easily restore permissions for a specific VM (or all VMs) on your Lab Host, it requires the Hyper-V PowerShell Module to get the VMId and then builds the required ACE and adds it to the virtual disk file’s ACL.</p>  <p>As always, please don’t use this in production without thoroughly testing. This is meant for Lab environments.</p>  <h1>Verify</h1>  <p>Just try to start your VM again, or have a look at the .vhd or .vhdx files security settings and find a similar looking entry:</p>  <p><a href="/assets/archive/image_574.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="/assets/archive/image_thumb_572.png" width="179" height="244" /></a> </p>  <p>&#160;</p>  <p>so long,    <br />tom </p>
{% include imported_disclaimer.html %}
